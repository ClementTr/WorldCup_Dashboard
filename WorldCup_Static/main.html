<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Russian World Cup - Data">
    <meta name="author" content="DataDeer">
    <meta name="keywords" content="Data Science Analysis Big World Cup Football">

    <!-- Title Page-->
    <title>World Cup Dashboard</title>

    <!-- Favicons
    ================================================== -->
    <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="img/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="img/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="img/apple-touch-icon-114x114.png">

    <!-- Fontfaces CSS-->
    <link href="./css/font-face.css" rel="stylesheet" media="all">
    <link href="./vendor/font-awesome-5/css/fontawesome-all.min.css" rel="stylesheet" media="all">

    <!-- Bootstrap CSS-->
    <link href="./vendor/bootstrap-4.1/bootstrap.min.css" rel="stylesheet" media="all">

    <!-- Vendor CSS-->
    <link href="./vendor/animsition/animsition.min.css" rel="stylesheet" media="all">
    <link href="./vendor/wow/animate.css" rel="stylesheet" media="all">
    <link href="./css/emoji.css" rel="stylesheet">

    <!-- Main CSS-->
    <link href="./css/theme.css" rel="stylesheet" media="all">

    <!-- Simple Plot CSS -->
    <link href="./css/plots/simple_plot.css" rel="stylesheet" media="all">
    <style>
      .toolTip {
      	position: absolute;
        display: none;
        min-width: 80px;
        height: auto;
        background: none repeat scroll 0 0 #ffffff;
        border: 1px solid #6F257F;
        padding: 14px;
        text-align: center;
      }
      .tooltip {
        position: absolute;
        text-align: center;
        width: 0px;
        height: 0px;
        padding: 2px;
        font: 12px sans-serif;
        background: #E5E5E5;
        border: 0px;
        border-radius: 8px;
        pointer-events: none;
      }
      .tooltipshow {
        position: absolute;
        text-align: center;
        width: 100px;
        height: 50px;
        padding: 2px;
        font: 12px sans-serif;
        background: #E5E5E5;
        border: 0px;
        border-radius: 8px;
        pointer-events: none;
      }

      div.scrollmenu {
          background-color: white;
          overflow: auto;
          white-space: nowrap;
      }

      div.scrollmenu li {
          display: inline-block;
          color: white;
          text-align: center;
          padding: 14px;
          text-decoration: none;
      }

     </style>


</head>


<body class="animsition">
  <div class="page-wrapper">


        <!-- HEADER MOBILE-->
        <!-- <header class="header-mobile d-block d-lg-none">
            <div class="header-mobile__bar">
                <div class="container-fluid">
                    <div class="header-mobile-inner">
                        <a class="logo" href="http://www.datadeer.fr">
                            <img src="./img/datadeer_mobile.png" alt="DataDeer"/>
                        </a>
                        <button class="hamburger hamburger--slider" type="button">
                            <span class="hamburger-box">
                                <span class="hamburger-inner"></span>
                            </span>
                        </button>
                    </div>
                </div>
            </div>
            <nav class="navbar-mobile">
                <div class="container-fluid">
                    <ul class="navbar-mobile__list list-unstyled">

                      <li>
                        <a href="/fracro/">
                          <i class="fa fa-trophy" aria-hidden="true"></i>Final
                        </a>
                      </li>

                      <li>
                        <a href="/beleng/">
                          <i class="fa fa-heart" aria-hidden="true"></i>Play-off for third place
                        </a>
                      </li>

                      <li class="has-sub">
                          <a class="js-arrow" href="#">
                              <i class="fa fa-thermometer-full"></i>Semi-finals
                          </a>
                          <ul class="navbar-mobile-sub__list list-unstyled js-sub-list">
                            <li>
                               <a href="/engcro/">#CROENG</a>
                            </li>
                            <li>
                               <a href="/frabel/">#FRABEL</a>
                            </li>
                            <li>
                          </ul>
                      </li>

                      <li class="has-sub">
                          <a class="js-arrow" href="#">
                              <i class="fa fa-thermometer-three-quarters"></i>Quarter-finals
                          </a>
                          <ul class="navbar-mobile-sub__list list-unstyled js-sub-list">
                            <li>
                               <a href="/ruscro/">#RUSCRO</a>
                            </li>
                            <li>
                               <a href="/sweeng/">#SWEENG</a>
                            </li>
                            <li>
                               <a href="/brabel/">#BRABEL</a>
                            </li>
                            <li>
                               <a href="/urufra/">#URUFRA</a>
                            </li>
                          </ul>
                      </li>

                      <li class="has-sub">
                          <a class="js-arrow" href="#">
                              <i class="fa fa-thermometer-quarter"></i>Round of 16
                          </a>
                          <ul class="navbar-mobile-sub__list list-unstyled js-sub-list">
                            <li>
                               <a href="/coleng/">#COLENG</a>
                            </li>
                            <li>
                               <a href="/sweswi/">#SWESWI</a>
                            </li>
                            <li>
                               <a href="/beljpn/">#BELJPN</a>
                            </li>
                            <li>
                               <a href="/bramex/">#BRAMEX</a>
                            </li>
                            <li>
                               <a href="/croden/">#CRODEN</a>
                            </li>
                            <li>
                               <a href="/sparus/">#SPARUS</a>
                            </li>
                            <li>
                                <a href="/urupor/">#URUPOR</a>
                            </li>
                            <li>
                                <a href="/fraarg/">#FRAARG</a>
                            </li>
                          </ul>
                      </li>



                      <li class="has-sub">
                          <a class="js-arrow" href="#">
                              <i class="fa fa-users"></i>Group Phase
                          </a>
                          <ul class="navbar-mobile-sub__list list-unstyled js-sub-list">
                              <li>
                                  <a href="/engbel/">#ENGBEL</a>
                              </li>
                              <li>
                                  <a href="/serbra/">#SERBRA</a>
                              </li>
                              <li>
                                  <a href="/denfra/">#DENFRA</a>
                              </li>
                              <li>
                                  <a href="/ururus/">#URURUS</a>
                              </li>
                              <li>
                                  <a href="/polcol/">#POLCOL</a>
                              </li>
                              <li>
                                  <a href="/gerswe/">#GERSWE</a>
                              </li>
                              <li>
                                  <a href="/bracrc/">#BRACRC</a>
                              </li>
                              <li>
                                  <a href="/fraper/">#FRAPER</a>
                              </li>
                              <li>
                                  <a href="/uruksa/">#URUKSA</a>
                              </li>
                              <li>
                                  <a href="/polsen/">#POLSEN</a>
                              </li>
                              <li>
                                  <a href="/tuneng/">#TUNENG</a>
                              </li>
                              <li>
                                  <a href="/braswi/">#BRASWI</a>
                              </li>
                              <li>
                                  <a href="/fraaus/">#FRAAUS</a>
                              </li>
                              <li>
                                  <a href="/porspa/">#PORSPA</a>
                              </li>
                              <li>
                                  <a href="/rusara/">#RUSARA</a>
                              </li>
                          </ul>
                      </li>


                        <li>
                            <a href="/table">
                              <i class="fas fa-table"></i>Fixtures
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>
        </header> -->
        <!-- END HEADER MOBILE-->

        <!-- MENU SIDEBAR-->
        <aside class="menu-sidebar d-none d-lg-block" style="width: 220px;">
            <div class="logo">
                <a href="http://www.datadeer.fr">
                     <img src="./img/datadeer.png" alt="DataDeer"/>
                </a>
            </div>
            <div class="menu-sidebar__content js-scrollbar1">
                <nav class="navbar-sidebar">
                    <ul class="list-unstyled navbar__list">

                      <li>
                        <a href="#Final" onclick="show_final()">
                          <i class="fa fa-trophy" aria-hidden="true"></i>Final
                        </a>
                      </li>

                      <li>
                        <a href="#beleng" onclick="show_beleng()">
                          <i class="fa fa-heart" aria-hidden="true"></i>Play-off for third place
                        </a>
                      </li>

                      <li class="has-sub">
                          <a class="js-arrow" href="#">
                              <i class="fa fa-thermometer-full"></i>Semi-finals
                          </a>
                          <ul class="navbar-mobile-sub__list list-unstyled js-sub-list">
                            <li>
                               <a href="#croeng" onclick="show_croeng()">#CROENG</a>
                            </li>
                            <li>
                               <a href="#frabel" onclick="show_frabel()">#FRABEL</a>
                            </li>
                            <li>
                          </ul>
                      </li>

                      <li class="has-sub">
                          <a class="js-arrow" href="#">
                              <i class="fa fa-thermometer-three-quarters"></i>Quarter-finals
                          </a>
                          <ul class="navbar-mobile-sub__list list-unstyled js-sub-list">
                            <li>
                               <a href="#ruscro" onclick="show_ruscro()">#RUSCRO</a>
                            </li>
                            <li>
                               <a href="#sweeng" onclick="show_sweeng()">#SWEENG</a>
                            </li>
                            <li>
                               <a href="#brabel" onclick="show_brabel()">#BRABEL</a>
                            </li>
                            <li>
                               <a href="#urufra" onclick="show_urufra()">#URUFRA</a>
                            </li>
                          </ul>
                      </li>

                      <li class="has-sub">
                          <a class="js-arrow" href="#">
                              <i class="fa fa-thermometer-quarter"></i>Round of 16
                          </a>
                          <ul class="navbar-mobile-sub__list list-unstyled js-sub-list">
                            <li>
                               <a href="#coleng" onclick="show_coleng()">#COLENG</a>
                            </li>
                            <li>
                               <a href="#sweswi" onclick="show_sweswi()">#SWESWI</a>
                            </li>
                            <li>
                               <a href="#beljpn" onclick="show_beljpn()">#BELJPN</a>
                            </li>
                            <li>
                               <a href="#bramex" onclick="show_bramex()">#BRAMEX</a>
                            </li>
                            <li>
                               <a href="#croden" onclick="show_croden()">#CRODEN</a>
                            </li>
                            <li>
                               <a href="#sparus" onclick="show_sparus()">#SPARUS</a>
                            </li>
                             <li>
                                <a href="#urupor" onclick="show_urupor()">#URUPOR</a>
                             </li>
                              <li>
                                  <a href="#fraarg" onclick="show_fraarg()">#FRAARG</a>
                              </li>
                          </ul>
                      </li>


                      <li class="has-sub">
                          <a class="js-arrow" href="#">
                              <i class="fa fa-users"></i>Group Phase
                          </a>
                          <ul class="navbar-mobile-sub__list list-unstyled js-sub-list">
                              <li>
                                  <a href="#engbel" onclick="show_engbel()">#ENGBEL</a>
                              </li>
                              <li>
                                  <a href="#serbra" onclick="show_serbra()">#SERBRA</a>
                              </li>
                              <li>
                                  <a href="#denfra" onclick="show_denfra()">#DENFRA</a>
                              </li>
                              <li>
                                  <a href="#ururus" onclick="show_ururus()">#URURUS</a>
                              </li>
                              <li>
                                  <a href="#polcol" onclick="show_polcol()">#POLCOL</a>
                              </li>
                              <li>
                                  <a href="#gerswe" onclick="show_gerswe()">#GERSWE</a>
                              </li>
                              <li>
                                  <a href="#bracrc" onclick="show_bracrc()">#BRACRC</a>
                              </li>
                              <li>
                                  <a href="#fraper" onclick="show_fraper()">#FRAPER</a>
                              </li>
                              <li>
                                  <a href="#uruksa" onclick="show_uruksa()">#URUKSA</a>
                              </li>
                              <li>
                                  <a href="#polsen" onclick="show_polsen()">#POLSEN</a>
                              </li>
                              <li>
                                  <a href="#tuneng" onclick="show_tuneng()">#TUNENG</a>
                              </li>
                              <li>
                                  <a href="#braswi" onclick="show_braswi()">#BRASWI</a>
                              </li>
                              <li>
                                  <a href="#fraaus" onclick="show_fraaus()">#FRAAUS</a>
                              </li>
                              <li>
                                  <a href="#porspa" onclick="show_porspa()">#PORSPA</a>
                              </li>
                              <li>
                                  <a href="#rusara" onclick="show_rusara()">#RUSARA</a>
                              </li>
                          </ul>
                      </li>


                      <li>
                          <a href=".table.html">
                              <i class="fas fa-table"></i>Fixtures
                          </a>
                      </li>
                    </ul>
                </nav>
            </div>
        </aside>
        <!-- END MENU SIDEBAR-->


        <!-- PAGE CONTAINER-->
        <div class="page-container">


          <div class="main-content" style="padding-top: 10px;">
              <div class="section__content section__content--p10">
                  <div class="container-fluid">

                    <div class="row">

                        <!-- BLOCK TITLE MODIFY TITLE -->
                        <div class="col-lg-3">
                            <div class="au-card m-b-15" style="padding-bottom: 22px;">
                              <center>
                                <img id="picture0" class="rounded" style="border:1px solid #021a40; height: 100px; width:90px; height:45px;" alt="...">
                                <h1 id="score0" style="margin-top: 10px;"></h1>
                              </center>
                            </div>
                        </div>
                        <div class="col-lg-6">
                          <div class="au-card m-b-15" style="padding-bottom: 10px;">
                            <center>
                              <h4 class="title-3 m-b-30" style="vertical-align: middle;">Live Twitter Analysis</h4>
                              <div style="vertical-align: middle;" id="match"></div>
                            </center>
                          </div>
                        </div>
                        <div class="col-lg-3">
                          <div class="au-card m-b-15" style="padding-bottom: 22px;">
                            <center>
                             <img id="picture1" class="rounded" style="border:1px solid #021a40; width:90px; height:45px;" alt="...">
                             <h1 id="score1" style="margin-top: 10px;"></h1>
                            </center>
                          </div>
                        </div>

                         <!-- <div class="col-lg-12">
                          <div class="au-card m-b-15" style="padding-bottom: 20px;background: #007bff; padding-top: 20px;">
                            <div style="vertical-align: middle; color: #fff; margin-bottom: 0px">EMOJIS MOST USED</div>
                            <div class="scrollmenu" style="background: #007bff">
                              {% for x in emojis %}
                              <li><i class="em em-{{x.Emoji}}"></i> x{{x.Count}}</li>
                              {% endfor %}
                            </div>
                          </div>
                        </div> -->


                        <div class="col-lg-4">
                            <div class="au-card m-b-15" style="padding-left: 25px;padding-right: 10px;">
                                <div class="au-card-inner">
                                    <h3 class="title-2 m-b-40">Twitter Buzz XI</h3>
                                    <div class="chart-wrapper" id="pitch_plot"></div>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-8" style="padding-left:7px;">
                            <div class="au-card m-b-15" style="padding-left: 20px;">
                                <div class="au-card-inner">
                                    <h3 class="title-2 m-b-40">Most quoted players live</h3>
                                    <div class="chart-wrapper" id="multi_playersChart"></div>
                                </div>
                            </div>
                        </div>


                        <div class="col-lg-9">
                            <div class="au-card m-b-15">
                                <div class="au-card-inner">
                                    <h3 class="title-2 m-b-40">Where Do the Tweets come from ?</h3>
                                    <div class="card-body" id="container1"></div>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-3">
                              <div class="au-card au-card--bg-blue au-card-top-countries m-b-15">
                                  <div class="au-card-inner">
                                    <h3 class="title-3 m-b-30 text-white">Top Countries Tweets</h3>
                                      <div class="table-responsive">
                                          <table class="table table-top-countries text-white" id="data-table">
                                              <tbody>

                                              </tbody>
                                          </table>
                                      </div>
                                  </div>
                              </div>
                        </div>


                        <div class="col-lg-6">
                            <div class="au-card m-b-15" style="padding-right:7px;">
                                <div class="au-card-inner">
                                    <h3 class="title-2 m-b-40">Which Team Does Twitter Support ?</h3>
                                    <div class="chart-wrapper" id="bar_plot"></div>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-6" style="padding-left:7px;">
                            <div class="au-card m-b-15" style="padding-left: 20px;">
                                <div class="au-card-inner">
                                    <h3 class="title-2 m-b-40">Popularity of the Game on Twitter</h3>
                                    <div class="chart-wrapper" id="simple_plot"></div>
                                </div>
                            </div>
                        </div>


                        <div class="col-lg-4">
                            <div class="au-card m-b-15">
                                <div class="au-card-inner">
                                    <h3 class="title-2 m-b-40">Our favorite tweet</h3>
                                    <div id="fav_tweet">
                                    </div>
                                  </div>
                            </div>
                        </div>

                        <div class="col-lg-4" style="padding-left:7px;">
                          <div class="au-card m-b-15">
                                <div class="au-card-inner">
                                    <h3 class="title-2 m-b-40">Our favorite goal tweet</h3>
                                    <div id="goal_tweet">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-4">
                            <div class="au-card m-b-15">
                                <div class="au-card-inner">
                                    <h3 class="title-2 m-b-40">Deertweet tweets by itself</h3>
                                    <div id="rnn_tweet">
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>


                  </div>
              </div>
          </div>




          <div class="row">
              <div class="col-md-12">
                  <div class="copyright">
                      <p>© 2018, Créé par DataDeer - <a href="http://datadeer.fr/cgu.html">CGU</a> | <a href="http://datadeer.fr/mentions_legales.html">Mentions légales</a>.</p>
                  </div>
              </div>
          </div>

        </div>
        <!-- END PAGE CONTAINER-->

  </div>
</body>

<script src="./js/twitter_displayer.js"></script>

<!-- Jquery JS-->
<script src="./vendor/jquery-3.2.1.min.js"></script>
<!-- Bootstrap JS-->
<script src="./vendor/bootstrap-4.1/popper.min.js"></script>
<script src="./vendor/bootstrap-4.1/bootstrap.min.js"></script>
<!-- Vendor JS       -->
<script src="./vendor/wow/wow.min.js"></script>
<script src="./vendor/animsition/animsition.min.js"></script>
<script src="./vendor/bootstrap-progressbar/bootstrap-progressbar.min.js"></script>
<script src="./vendor/perfect-scrollbar/perfect-scrollbar.js"></script>

<!-- D3js -->
<script src="./js/d3/d3v4.min.js"></script>

<!-- Main JS-->
<script src="./js/main.js"></script>

<!-- LINE CHART POSNEG -->
<script src="./js/plots/multi_players_chart.js" type="text/javascript"></script>
<!-- MULTI LINE CHART PLAYERS -->
<script src="./js/plots/multi_lines_chart.js" type="text/javascript"></script>
<!-- BAR PLOT -->
<script src="./js/plots/barplot_chart.js" type="text/javascript"></script>
<!-- PITCH -->
<script src="./js/plots/pitch.js" type="text/javascript"></script>


<!-- MULTI LINES CHART -->
<script type="text/javascript">
  d3v4 = d3

  window.addEventListener("resize", redraw)
  const margin_plot = {
      top: 10,
      right: 10,
      bottom: 60,
      left: 60,
  };
  let div_plot = document.getElementById("simple_plot");
  let svg_plot_init = d3v4.select("#simple_plot").append("svg")

  var format_date_base = d3v4.timeFormat("% %H:%M");
  var format_date = d3v4.timeFormat("%H:%M");
  let bisect_date_plot = d3v4.bisector(d => d.Time).left;

  let dataset_plot = []
  let x_plot, y_plot;
  let svg_plot;

  // let matchname = ""

  function draw_multi_lines(matchname){
    d3v4.csv("./data/"+matchname.slice(1,7)+"/"+matchname.slice(1,7)+"_Sentiments_Agg.csv")
        .row(d => {
            return {
                Time: new Date(d.Time),
                Negative: +d.Negative,
                Positive: +d.Positive
            }
        })
        .get((error, rows) => {
            if (rows.length > 0) {

                x_plot = d3v4.scaleTime()
                        .domain(d3v4.extent(rows, row => row.Time))
                y_plot = d3v4.scaleLinear()
                        .domain([0, d3v4.max(rows, row => Math.max(row.Negative, row.Positive))])

                dataset_plot = rows


                redraw();

            }
        });
  }
</script>


<!-- MULTI PLAYERS CHART -->
<script type="text/javascript">
  window.addEventListener("resize", redraw_players)
  const margin_players = {
      top: 50,
      right: 10,
      bottom: 60,
      left: 60,
  };
  let div_players = document.getElementById("multi_playersChart");
  let svg_players_init = d3v4.select("#multi_playersChart").append("svg")

  let bisect_date_players = d3v4.bisector(d => d.Time).left;

  let dataset_players = []
  let x_players, y_players;
  let svg_players;

  let x_circle_player;
  let x_image_player;

  let Name_1, Name_2, Name_3, Name_4, Name_5;
  let Percentage_1, Percentage_2, Percentage_3, Percentage_4, Percentage_5;
  let Country_1, Country_2, Country_3, Country_4, Country_5;
  let max_player1, max_player2, max_player3, max_player4, max_player5


  function draw_multi_players_chart(matchname){
    d3v4.json("./data/"+matchname.slice(1,7)+"/"+matchname.slice(1,7)+"_Timeseries_Players.json", function(error, myData) {

      let len_data_players = myData.length

      Percentage_1 = myData[len_data_players-1]["Percentage1"]
      Percentage_2 = myData[len_data_players-1]["Percentage2"]
      Percentage_3 = myData[len_data_players-1]["Percentage3"]
      Percentage_4 = myData[len_data_players-1]["Percentage4"]
      Percentage_5 = myData[len_data_players-1]["Percentage5"]

      Country_1 = myData[len_data_players-1]["Pays1"]
      Country_2 = myData[len_data_players-1]["Pays2"]
      Country_3 = myData[len_data_players-1]["Pays3"]
      Country_4 = myData[len_data_players-1]["Pays4"]
      Country_5 = myData[len_data_players-1]["Pays5"]

      Name_1 = myData[len_data_players-1]["Player1"]
      Name_2 = myData[len_data_players-1]["Player2"]
      Name_3 = myData[len_data_players-1]["Player3"]
      Name_4 = myData[len_data_players-1]["Player4"]
      Name_5 = myData[len_data_players-1]["Player5"]

      myData.forEach(function(item, index){
        date = new Date(item["Time"])
        dataset_players.push({"Time": date,
          "Percentage1": Number(item["Percentage1"]),
          "Percentage2": Number(item["Percentage2"]),
          "Percentage3": Number(item["Percentage3"]),
          "Percentage4": Number(item["Percentage4"]),
          "Percentage5": Number(item["Percentage5"])});
      });

      bisect_date_players = d3v4.bisector(function(d) { return d["Time"];}).left;

      x_players = d3v4.scaleTime()
                      .domain(d3v4.extent(dataset_players, function(d) {
                      return d["Time"];
                    }));
      y_players = d3v4.scaleLinear()
              .domain([0, d3v4.max(dataset_players,function(d) {
                  return Math.max(d["Percentage1"], d["Percentage2"], d["Percentage3"], d["Percentage4"], d["Percentage5"]);
                  }
                )]);

      max_player1 = d3v4.max(dataset_players,function(d) {return Math.max(d["Percentage1"])})
      max_player2 = d3v4.max(dataset_players,function(d) {return Math.max(d["Percentage2"])})
      max_player3 = d3v4.max(dataset_players,function(d) {return Math.max(d["Percentage3"])})
      max_player4 = d3v4.max(dataset_players,function(d) {return Math.max(d["Percentage4"])})
      max_player5 = d3v4.max(dataset_players,function(d) {return Math.max(d["Percentage5"])})

      older_date = d3v4.max(dataset_plot, d => Math.max(d.Time))

      redraw_players();

    });
  }


</script>


<!-- BARPLOT CHART -->
<script type="text/javascript">
  window.addEventListener("resize", redraw_barplot)
  let compteur_resize_bar = 0
  const margin_barplot = {
      top: 10,
      right: 60,
      bottom: 60,
      left: 60,
  };

  let div_barplot = document.getElementById("bar_plot");
  let svg_barplot_init = d3v4.select("#bar_plot").append("svg")
  let svg_barplot
  let tooltip = d3v4.select("#bar_plot").append("div").attr("class", "toolTip");
  let w = div_barplot.clientWidth;
  let h = 250
  var x, y;

  let dataset_barplot;

  function draw_barplot_sentiments(matchname){
    d3v4.json("./data/"+matchname.slice(1,7)+"/"+matchname.slice(1,7)+"_Sentiments.json", function(error, myData) {
      dataset_barplot = myData;
       x = d3v4.scaleLinear()
       y = d3v4.scaleBand()
      redraw_barplot()
    });
  }

</script>


<!-- PITCH PLOT -->
<script type="text/javascript">
  window.addEventListener("resize", redraw_pitch)
  const margin_pitch = {
      top: 0,
      right: 10,
      bottom: 0,
      left: 10,
  };

  let div_pitchplot = document.getElementById("pitch_plot");
  let svg_pitch_init = d3.select('#pitch_plot').append('svg')

  let width_pitch = div_pitchplot.clientWidth;
  let height_pitch = 610
  var x, y;

  let w_pitch
  let h_pitch
  let max_width_available = 0

  let keeper_name
  let keeper_country
  let defenders_name
  let midfielders_name
  let midfielders_country
  let attackers_name
  let attackers_country


  function draw_pitch_buzz(matchname){
    d3v4.json("./data/"+matchname.slice(1,7)+"/"+matchname.slice(1,7)+"_Top11Players.json", function(error, myData) {
      // console.log(myData);
      keeper_name = myData["Name"]["Keeper"][0]
      keeper_country = myData["Country"]["Keeper"][0]

      defenders_name = myData["Name"]["Defenders"]
      defenders_country = myData["Country"]["Defenders"]

      midfielders_name = myData["Name"]["Midfielders"]
      midfielders_country = myData["Country"]["Midfielders"]

      attackers_name = myData["Name"]["Attackers"]
      attackers_country = myData["Country"]["Attackers"]

      redraw_pitch()
    });
  }

  window.d3 = null
</script>


<script src="./js/d3/d3v3.min.js"></script>
<script src="./js/topojson.min.js" type="text/javascript"></script>
<script src="./js/datamaps.all.js" type="text/javascript"></script>
<script>

function loadTable(tableId, fields, data) {
  var rows = '';
  $.each(data, function(index, item) {
      var row = '<tr>';
      $.each(fields, function(index, field) {
        if(index == 0){
          row += '<td>' + item[index]  + '</td>';
        }else{

          row += '<td class=\"text-right\">' + item[index]+"%" + '</td>';
        }
      });
      rows += row + '<tr>';
  });
  $('#' + tableId).html(rows);
}

  var series = [];
  var oppostion = "{{hashtag}}"

  function draw_map_countries(matchname){
    d3.csv("./data/"+matchname.slice(1,7)+"/"+matchname.slice(1,7)+"_Nations.csv", function(data) {
      for(var i = 0;i<data.length;i++){
          series.push([data[i]['Nation'], data[i]['Count']]);
      }


    var top10_team = series.slice(0, 11);

    loadTable('data-table', ['field1', 'field2'], top10_team);

    var dataset = {};

    var onlyValues = series.map(function(obj){ return obj[1]; });
    var minValue = Math.min.apply(null, onlyValues),
          maxValue = Math.max.apply(null, onlyValues);

    var paletteScale = d3.scale.linear()
          .domain([minValue,maxValue])
          .range(["#EFEFFF","#02386F"]); // blue color

    series.forEach(function(item){
        var iso = item[0],
                value = item[1];
        dataset[iso] = { numberOfThings: value, fillColor: paletteScale(value) };
    });

    map = new Datamap({
        element: document.getElementById('container1'),
        projection: 'mercator',
        fills: { defaultFill: '#F5F5F5' },
        responsive: true,
        geographyConfig: {
          borderColor: '#DEDEDE',
          highlightBorderWidth: 2,
          highlightBorderColor: '#B7B7B7',
          highlightFillColor: function(geo) {
              return geo['fillColor'] || '#F5F5F5';
          },
          popupTemplate: function(geo, data) {
              // don't show tooltip if country don't present in dataset
              if (!data) { return ; }
              // tooltip content
              return ['<div class="hoverinfo">',
                  '<strong>', geo.properties.name, '</strong>',
                  '<br>Percentage of Tweets : <strong>', data.numberOfThings, '</strong>',
                  '</div>'].join('');
          }
        },
        data: dataset
    });
    window.addEventListener('resize', function(event) { map.resize(); });
  });
  }
</script>


<script>
  show_final()
</script>
